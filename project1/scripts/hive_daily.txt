use project1;

use project1;

truncate table day;



set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partition=true;

load data inpath '/user/saif/project1/day/' into table day;

insert overwrite table tgt partition(year,month) (select d.custid,d.username,d.quote_count,d.ip,d.entry_time,d.prp_1,d.prp_2,d.prp_3,d.ms,d.http_type,d.purchase_category,d.total_count,d.purchase_sub_category,d.http_info,d.status_code,d.date_col,d.year,d.month from tgt st full outer join day d on st.custid = d.custid where d.custid is not null) union (select st.custid,st.username,st.quote_count,st.ip,st.entry_time,st.prp_1,st.prp_2,st.prp_3,st.ms,st.http_type,st.purchase_category,st.total_count,st.purchase_sub_category,st.http_info,st.status_code,st.date_col,st.year,st.month from tgt st full outer join day d on st.custid = d.custid where d.custid is null);
  
  

truncate table temp_stg;
insert overwrite table temp_stg select * from tgt;
